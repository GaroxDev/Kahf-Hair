<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/assets/images/favicon.png" sizes="any" />
  <title>KAHF Virtual Hair Try-On 2025</title>
  <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
  <link rel="stylesheet" href="/assets/css/hair-style.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <script>
    let eulerY = 0;
  </script>
  <script type="module" src="/assets/js/owl.carousel.min.js"></script>
  <script src="/assets/js/three.min.js"></script>
  <script src="/assets/js/GLTFLoader.js"></script>
  <script type="module" src="/assets/js/OrbitControls.js"></script>
  <!-- <script src="/assets/js/dom-to-image.min.js"></script> -->
  <script src="/assets/js/jquery-3.6.0.min.js"></script>
  <script type="module" src="/assets/js/model-viewer.min.js"></script>
  <script src="/assets/js/qrcode.min.js"></script>
  <!-- <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> -->
</head>

<body>
  <div class="kahf-container">

    <section id="home-page-hair" class="home-page kahf-screen">
      <img class="logo" src="/assets/images/KV-Hair.png" alt="">
      <img class="logo-decode" src="/assets/images/kahf-logo.png" alt="">
      <img class="logo-desc" src="/assets/images/kahf-desc.png" alt="">
      <div class="d-flex gap-3 mt-5 justify-content-center align-items-center">
        <button id="button-scan-qr" class="kahf-btn kahf-btn-accent d-none" style="width: 220px;">
          SCAN QR
        </button>
        <button id="button-fill-form" class="kahf-btn kahf-btn-accent d-none" style="width: 220px;">
          FILL FORM
        </button>
        <div id="instruct-home" class="instruct d-none">NO QR? START HERE</div>
        <div class="splash-loading justify-content-center align-items-center">
          <i class="fas fa-spinner fa-spin me-2"></i>
          <span>Please Wait</span>
        </div>
      </div>
    </section>
    <section id="register-form" class="p-0 register kahf-screen regist hidden" >
      <img class="icon-back" src="/assets/images/icon-back.png" alt="">
      <img class="logo-regist" src="/assets/images/logo-kahf.png" alt="">
      <div class="title" style="padding: 15%;">
        <img class="title-cover" src="/assets/images/title-cover.png" alt="">
        <h2>REGISTER <br>
        TO DECODE</h2>
        <h3>FILL IN YOUR DETAILS TO UNLOCK<br>
        THE EXPERIENCE.</h3>
        <form style="position: absolute; top: 42.5%; left:18%; width:46%;" id="regist-form">
          <label for="name">Full Name</label>
          <input type="text" id="name" placeholder="your name">
          <label for="phone">Whatsapp Number</label>
          <input type="text" id="phone" placeholder="your number">
        </form>
        <div class="checkbox-group">
        <label class="checkbox-item">
          <input type="checkbox" id="privacy" required>
          <span class="checkbox-span">See our <a href="#">Privacy Policy</a> for more information.</span>
        </label>

        <label class="checkbox-item-2">
          <input type="checkbox" id="privacy">
          <span  class="checkbox-span-2">I agree to receive promotional & further information from Kahf (Optional)</span>
        </label>
      </div>
        <button type="submit" id="regist-submit-btn" class="kahf-btn kahf-btn-accent">NEXT</button>
      </div>
    </section>
    <section id="face-scan-hair" class="face-scan p-0 kahf-screen page-stye-1 hidden">
      <div class="header">
        <img class="icon-back" src="/assets/images/icon-back.png" alt="">
        <img class="logo-decode" src="/assets/images/kahf-logo.png" alt="">
        <img class="logo" src="/assets/images/logo-scan-wajah.png" alt="">
      </div>

      <!-- INTRO -->
      <div class="intro-text">
        <h2 class="greeting">HAI !!!</h2>
        <p class="desc">
          WE'LL ANALYZE YOUR FACE SHAPE TO SUGGEST SUITABLE HAIRSTYLES AND PRODUCTS.
        </p>
      </div>

      <div id="face-scan-container" class="mb-3">
        <img class="ellipse" src="/assets/images/ellipse.png" alt="">
        <div class="scan-helper-container" id="scan-helper">
          <div class="scan-helper-text" id="scan-helper-text"></div>
          <div class="scan-progress">
            <div class="progress-bar" id="scan-progress"></div>
          </div>
        </div>
      </div>
      <button id="scan-btn" class="kahf-btn kahf-btn-accent">
        <span>SCAN</span>
      </button>
    </section>
    <!-- Question Hair -->
    <section id="page-question-hair" class="question p-0 kahf-screen page-stye-1 hidden">
      <div class="header">
      <img class="icon-back" src="/assets/images/icon-back.png" alt="">
      </div>
      <img class="logo" src="/assets/images/question-logo.png" alt="">
      <img class="logo-decode" src="/assets/images/kahf-logo.png" alt="">
      <h2>APA TIPE RAMBUTMU?</h2>
      <div class="question-wrapper question-text-container">
        <div class="question-list question-text" data-value="Straight">
          <span>Straight</span>
        <img src="./assets/images/Straight.png"></div>
        <div class="question-list question-text" data-value="Wavy">
          <span>Wavy</span>
        <img src="./assets/images/Wavy.png"></div>
        <div class="question-list question-text" data-value="Curly">
          <span>Curly</span>
        <img src="./assets/images/Curly.png"></div>
      </div>
    </section>

    <section id="loading-screen" class="loading p-0 kahf-screen page-stye-1 hidden">
      <div class="header">
        <img class="icon-back" src="/assets/images/icon-back.png" alt="">
      </div>
      <img class="logo" src="/assets/images/loading-logo.png" alt="">
      <img class="logo-decode" src="/assets/images/kahf-logo.png" alt="">
      <img class="logo-desc" src="/assets/images/kahf-desc.png" alt="">
      <div class="result-loading justify-content-center align-items-center">
          <i class="custom-spinner me-2"></i>
          <span>Please Wait</span>
        </div>
    </section>
    
    <section id="face-result-screen" class="kahf-screen hidden">
      <img class="logo mb-5" width="30%" style="max-width: 200px;" src="/assets/images/logo-hair.png" alt="">
      <button class="kahf-btn kahf-btn-accent back-btn">
        <span>Back</span>
      </button>
      <div class="face-shape-card">
        <div class="d-flex gap-5 justify-content-center mb-4">
          <!-- Foto user -->
          <div class="wrapper-captured captured-left">
            <img id="preview-img" src="/assets/images/default.png" alt="Preview">
            <div class="shape-name">Your Photo</div>
          </div>
          <!-- Hasil prediksi -->
          <div class="wrapper-captured captured-right">
            <img id="result-img" src="/assets/images/default.png" alt="Result">
            <div class="shape-name" id="result-shape">Result</div>
          </div>
        </div>

        <!-- Info hasil prediksi -->
        <div class="face-shape-info mb-4">
          <p class="mb-2 shape-title">Face Shape Result</p>
          <p class="shape-desc" id="shape-desc">
            Upload your face photo to get recomendation.
          </p>
        </div>
      </div>


    <button id="result-continue-btn" class="kahf-btn kahf-btn-accent">
      CONTINUE
    </button>
    </section>

    <!-- Hairstyle Selection Screen -->
    <section id="hairstyle-screen" class="p-0 kahf-screen page-stye-1 hidden">
      <div class="header">
        <img class="icon-back" src="/assets/images/icon-back.png" alt="">
        <img class="logo-decode" src="/assets/images/logo-decode-1.png" alt="">
        <img class="logo" src="/assets/images/logo-header.png" alt="">
      </div>
      <!-- <h1 class="kahf-title mb-5">Hairstyle Selection</h1> -->

      <!-- Three.js Container - Single consistent element -->
      <div class="hairstyle-grid">
        <div class="hairstyle-grid-inner">
          <div class="hairstyle-item" data-model-index="0">
            <div class="hairstyle-img">
              <model-viewer src="/assets/models/model-4.glb" alt="A 3D model" style="--poster-color: transparent;">
                <div slot="poster"></div>
                <div slot="progress-bar"></div>
              </model-viewer>
              <!-- <img src="/assets/images/image 11.png" alt=""> -->
            </div>
            <div class="hairstyle-name">TWO BLOCK</div>
          </div>
          <div class="hairstyle-item" data-model-index="1">
            <div class="hairstyle-img">
              <model-viewer src="/assets/models/model-5.glb" alt="A 3D model" style="--poster-color: transparent;">
                <div slot="poster"></div>
                <div slot="progress-bar"></div>
              </model-viewer>
              <!-- <img src="/assets/images/image 11.png" alt=""> -->
            </div>
            <div class="hairstyle-name">BUZZCUT</div>
          </div>
          <div class="hairstyle-item" data-model-index="2">
            <div class="hairstyle-img">
              <model-viewer src="/assets/models/model-12.glb" alt="A 3D model" style="--poster-color: transparent;">
                <div slot="poster"></div>
                <div slot="progress-bar"></div>
              </model-viewer>
              <!-- <img src="/assets/images/image 12.png" alt=""> -->
            </div>
            <div class="hairstyle-name">FRENCH CROP</div>
          </div>
        </div>
      </div>
      <div class="sidebar-hair">
        HAIRSTYLE SELECTION
      </div>
      <button id="button-style-vault" class="kahf-btn kahf-btn-accent button-small">
        more hair style (200)
      </button>

      <div class="scene-container">
        <canvas id="renderCanvas1"></canvas>
        <!-- <model-viewer auto-rotate camera-controls id="hair_0" src="/assets/models/hair-1.glb" data-hair="hair-1" alt="A 3D model"></model-viewer>
        <model-viewer auto-rotate camera-controls id="hair_1" src="/assets/models/hair-2.glb" data-hair="hair-2" alt="A 3D model"></model-viewer>
        <model-viewer auto-rotate camera-controls id="hair_2" src="/assets/models/hair-3.glb" data-hair="hair-3" alt="A 3D model"></model-viewer> -->
        <!-- <div class="scene-name"></div> -->
        <!-- Three.js will create its own canvas here -->
        <!-- <img class="rotate-icon" src="/assets/images/rotate-icon.png" alt=""> -->
        <div class="rotate-controls">
          <button id="btnLeft" class="kahf-btn kahf-btn-accent">&laquo;</button>
          <button id="btnRight" class="kahf-btn kahf-btn-accent">&raquo;</button>
        </div>
      </div>
      <button id="hairstyle-continue-btn" class="kahf-btn kahf-btn-accent">
        next
      </button>
      <div id="sidebar-hair-style" class="sidebar">
         Curtain Waves
      </div>
    </section>

    <!-- Hairstyle List Selection Screen -->
    <section id="hairstyle-list-screen" class="p-0 kahf-screen page-stye-1 hidden"> 
      <div class="header">
        <img class="icon-back" src="/assets/images/icon-back.png" alt="">
        <img class="logo-decode" src="/assets/images/logo-decode.png" alt="">
        <img class="logo" src="/assets/images/logo-header.png" alt="">
      </div>

      <div class="first-three-grid">
        <div class="first-three-grid-inner">
          <div id="first-three-grid-inner-list" class="first-three-grid-inner-list">
            <!-- First 3 hairstyle items will be rendered here by renderFirstThreeImages() -->
          </div>

          <div class="sidebar-hair-list">
            FIRST 3 HAIRSTYLES
          </div>
        </div>
      </div>

      <div class="hairstyle-grid">
        <div class="hairstyle-grid-inner">
          <div id="hairstyle-grid-inner-list" class="hairstyle-grid-inner-list">
            <div class="loading-indicator">
              <p>Loading hairstyles...</p>
            </div>
          </div>
          
          <div class="sidebar-hair-list">
            HAIRSTYLE
          </div>
        </div>
      </div>
    </section>

    <!-- Product Recommendation Screen -->
    <section id="product-hair-screen" class="p-0 kahf-screen page-stye-1 hidden">
      <div class="header">
        <img class="icon-back" src="/assets/images/icon-back.png" alt="">
        <img class="logo-decode" src="/assets/images/logo-decode-1.png" alt="">
        <img class="logo" src="/assets/images/logo-header.png" alt="">
      </div>
      <div class="sidebar-prod">
        PRODUCTS RECOMMENDATION
      </div>

      <div class="result-card">
        <div class="product-body">
          <div class="d-flex gap-3 justify-content-center mb-2">
            <!-- Left card -->
            <div class="card-prod card-prod-result">
              <div class="left-card-prod">
                <h3>Face <br>
                  Result</h3>
                <div id="face-type" class="face-type">OVAL</div>
                <h4>Type Hair</h4>
                <div class="hair-type-detail">Straight</div>
              </div>
              <div class="right-card-prod">
                <img id="face-shape-img" class="face-img" src="/assets/images/oval-1.png" />
              </div>
            </div>
            <!-- Right card -->
            <div id="face-shape-des" class="card-prod card-prod-desc">
              The most balanced and versatile face shape, with a slightly wider forehead than jawline.
              Almost any hairstyle works well, from short, sharp crops to longer, layered looks,
              giving you the freedom to experiment.
            </div>
          </div>
        </div>
      </div>

      <div class="product-card">
        <div class="model-img">
          <img id="result-hairstyle-img">
          <!-- <model-viewer id="product-model-viewer" src="/assets/models/model-4.glb" alt="Model 1" style="--poster-color: transparent;">
            <div slot="poster"></div>
            <div slot="progress-bar"></div>
          </model-viewer> -->
        </div>
        <div class="product-info">
          <h3>Hair Style
            <br>Recommendations
          </h3>
          <h2 id="product-hair-style-name" style="margin-top: 15px;font-weight: bold;font-size: 150%;">Curtain Waves</h2>
        </div>
        <p id="product-hair-style-desc" style="padding-top: 19px; padding-right: 10px; font-size: 11px; text-align: left;">
          The most balanced and versatile
          <br>face shape, with a slightly 
          <br>wider forehead than jawline. 
          <br>Almost any hairstyle works 
          <br>well, from short, sharp crops 
          <br>to longer, layered looks, 
          <br>giving you the freedom to 
          <br>experiment.</p>
      </div>
      <div class="product-result-container">
        <!-- Produk 1 -->
      <div class="product-card">
        <div class="product-info">
          <h3>Hair
            <br>Styling</h3>
          <h4>KAHF</h4>
          <p>Kahf Sleek Classy Water Based Pomade</p>
          <button>PRODUCT INFORMATION</button>
        </div>
        <div class="product-img">
          <img src="/assets/images/pomade-sleek.png" alt="Pomade 1">
        </div>
      </div>

      <!-- Produk 2 -->
      <div class="product-card">
        <div class="product-info">
          <h3>Hair
            <br>Styling</h3>
          <h4>KAHF</h4>
          <p>Kahf Matte Dapper Water Based Pomade</p>
          <button>PRODUCT INFORMATION</button>
        </div>
        <div class="product-img">
          <img src="/assets/images/pomade-matte.png" alt="Pomade 2">
        </div>
      </div>

      <!-- Produk 3 -->
      <div class="product-card">
        <div class="product-info">
          <h3>Hair
            <br>Styling</h3>
          <h4>KAHF</h4>
          <p>Kahf Sleek Classy Water Based Pomade</p>
          <button>PRODUCT INFORMATION</button>
        </div>
        <div class="product-img">
          <img src="/assets/images/pomade-sleek.png" alt="Pomade 1">
        </div>
      </div>
      </div>

      <!-- Button -->
      <div class="d-flex gap-4 button-inline-wrapper justify-content-center align-items-center">
        <button id="finish-page-hair-product" class="button-to-home kahf-btn kahf-btn-accent" style="width: 50%;">
          Finish
        </button>

        <button id="share-result" class="kahf-btn kahf-btn-accent" style="width: 50%" onclick="generateResultQR()">
          Share
        </button>

        <!-- Pop Up QR Code -->
        <div id="qrModal" class="qr-modal">
          <div class="qr-modal-content">
            <span class="close">&times;</span>
            <h3 class="qr-text">Scan QR Code For Share Your Result</h3>
            <div id="qr_image_modal" style="display: inline-block;">
            </div>
          </div>
        </div>
    </section> 
  </div>

  <div id="captured-photo">
  </div>

    <script type="importmap">
      {
      "imports": {
        "three": "/assets/js/three.module.js",
        "three/addons/": "/assets/js/three/addons/",
        "mindar-face-three":"/assets/js/mindar-face-three.prod.js"
      }
    }
  </script>

 <script>
  
  // Screen navigation
  const screens = {
    profile: $('#profile-screen'),
    splash: $('#splash-screen'),
    landing: $('#landing-screen'),
    startScan: $('#start-qr-screen'),
    
    // hair
    homePageHair: $('#home-page-hair'),
    scan: $('#face-scan-screen'),
    result: $('#face-result-screen'),
    hairstyle: $('#hairstyle-screen'),
    pageQuestionHair: $('#page-question-hair'),
    hairstyleList: $('#hairstyle-list-screen'),
    registForm: $('#register-form'),
    product: $('#product-hair-screen'),
    scanAnalyzer: $('#skin-analyzer-splash'),
    scanHairAnalyzer: $('#hair-analyzer-splash'),
    scanSkin: $('#face-scan-skin'),
    scanHair: $('#face-scan-hair'),
    scanAnalyzerSelection: $('#skin-analyzer-selection'),
    homePage: $('#home-page'),
    pageForm: $('#page-form'),
    pageIntro: $('#page-intro'),
    loading: $('#loading-screen'),
    // skin analyzer
    pageResultSkin: $('#page-result'),
    pageSkinResult: $('#face-result-skin'),
    pageSkinScore: $('#page-skin-score'),
    pageSkinProduct: $('#page-result-product'),
    pageQuestionAge: $('#page-question-age'),
    questionSkinCondition: $('#page-question-skin-condition'),
    questionDirectSunlight: $('#page-question-direct-sunlight'),
    questionPersonalConcern: $('#page-question-dry-concerns'),
    questionLivein: $('#page-question-livein'),
    // i dont know
    questionDescribeSkin: $('#page-question-describe-skin'),
    questionPoresSkin: $('#page-question-pores'),
    questionAfternoon: $('#page-question-afternoon'),
    questionBlemishes: $('#page-question-blemishes'),
    questionMorning: $('#page-question-morning'),
    // skin condition
    questionNormalSkin: $('#page-question-normal-concerns'),
    questionOilySkin: $('#page-question-oily-concerns'),
    questionCombinationSkin: $('#page-question-combination-concerns'),
    questionDullSkin: $('#page-question-dull-concerns'),
    questionDrySkin: $('#page-question-dry-concerns'),
    questionAcneSkin: $('#page-question-acne-concerns'),
    // result
    resultSkinType: $('#page-result-skintype')
  }

  const checkbox = document.getElementById("privacy");
  const button = document.getElementById("take-selfie-hair");

  // Event listener untuk toggle button
  checkbox.addEventListener("change", function () {
    button.disabled = !this.checked;
  });

  // --- Face capture variables ---
  let currentAngle = 0;
  let targetAngle = 0;
  let texturePath = '';
  let capturedImages = [];
  
  document.addEventListener('DOMContentLoaded', function() {
            const hairTypeOptions = document.querySelectorAll('.question-list');
            const resultCard = document.querySelector('.result-card');
            const hairTypeDetail = document.querySelector('.hair-type-detail');
            
            hairTypeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Hapus kelas 'selected' dari semua opsi
                    hairTypeOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Tambahkan kelas 'selected' ke opsi yang diklik
                    this.classList.add('selected');
                    
                    // Ambil nilai dari opsi yang dipilih
                    const selectedHairType = this.getAttribute('data-value');
                    
                    // Simpan nilai ke dalam elemen hair-type-detail
                    hairTypeDetail.textContent = selectedHairType;
                    
                    // Tampilkan result-card
                    resultCard.style.display = 'block';
                    
                    // Simpan pilihan user (bisa dikembangkan untuk disimpan ke database)
                    console.log('User memilih:', selectedHairType);
                    // Di sini Anda bisa menambahkan kode untuk mengirim data ke server
                });
            });
        });
  
  let qrCode = null;
  let qrResult = null;
  
  // --- QR Result ---
  function generateResultQR() {
    if (!qrResult) {
      qrResult = new QRCode("qr_image_modal", {
      text: "https://www.kahfeveryday.com/",
      width: 256,
      height: 256,
      colorDark: "#3f4939",
      colorLight: "#ffffff",
      correctLevel: QRCode.CorrectLevel.H,
    });
  } else {
    qrResult.clear(); 
    qrResult.makeCode("https://www.kahfeveryday.com/");
  }
    
    
  console.log("QR Code generated for result.");
  document.getElementById("qrModal").style.display = "flex";
}



// Event listener untuk tombol share
    document.getElementById("share-result").addEventListener("click", function() {
      generateResultQR();
    });
    
    // Event listener untuk menutup modal
    $(".close").on("click", function() {
      $("#qrModal").fadeOut();
    });
    
    // Tutup modal jika diklik di luar area konten
    window.addEventListener("click", function(event) {
      const modal = document.getElementById("qrModal");
      if (event.target === modal) {
        modal.style.display = "none";
      }
    });

  function showScreen(screenName) {
    // Hide all screens
    Object.values(screens).forEach(screen => {
      $(screen).addClass('hidden'); // wrap with $()
    });

    // Show the requested screen
    $(screens[screenName]).removeClass('hidden'); // wrap with $()
  }


const faceShape = [
  {
    name: "Oval",
    image: "/assets/images/oval.png",
    description:
      "The most balanced and versatile face shape, with a slightly wider forehead than jawline. Almost any hairstyle works well, from short, sharp crops to longer, layered looks, giving you the freedom to experiment.",
  },
  {
    name: "Round",
    image: "/assets/images/round.png",
    description:
      "Characterized by equal width and length with soft jawlines. Hairstyles that add height and volume on top help elongate the face, while keeping the sides shorter for a sharper, more defined appearance.",
  },
  {
    name: "Square",
    image: "/assets/images/square.png",
    description:
      "Defined by a strong, angular jawline and balanced proportions. Textured or layered cuts help soften sharp angles, adding movement and balance without losing the masculine edge.",
  },
  {
    name: "Rectangle / Oblong",
    image: "/assets/images/rectangle.png",
    description:
      "Longer than it is wide, with a straight jawline. Styles with added volume on the sides help balance the length, while avoiding excessive height on top to keep proportions in check.",
  },
  {
    name: "Heart",
    image: "/assets/images/heart.png",
    description:
      "A broad forehead that tapers to a narrow, pointed chin. Hairstyles that add fullness and texture around the jawline create harmony and draw attention to the eyes and cheekbones.",
  },
  {
    name: "Diamond",
    image: "/assets/images/diamond.png",
    description:
      "Wide cheekbones with a narrow forehead and chin. Best paired with styles that bring volume or bangs to the forehead, balancing the width and adding softness to the overall look.",
  },
  {
    name: "Triangle",
    image: "/assets/images/triangle.png",
    description:
      "A wider jawline compared to the forehead. Opt for hairstyles with volume and fullness at the crown to balance proportions and add height, creating a more even silhouette.",
  },
];

// function untuk update UI dari hasil backend
function updateFaceShapeUI(predictedClass) {
   console.log("🎯 Predicted class:", predictedClass);
  // cari kecocokan berdasarkan nama (case insensitive)
  const match = faceShape.find(f =>
    f.name.toLowerCase().includes(predictedClass.toLowerCase())
  );

  if (match) {
    $(".face-img").attr("src", match.image);
    $(".card-prod-desc").text(match.description);
    $(".face-type").text(match.name);
  } else {
    // fallback kalau tidak ada di array
    $(".face-img").attr("src", "/assets/images/default.png");
    $(".card-prod-desc").text("No description available.");
    $(".face-type").text(predictedClass);
  }
}

function renderHairstyleItems(hairstyleData, lazyNine) { 
  const gridInnerList = document.getElementById('hairstyle-grid-inner-list');
  if (!gridInnerList) return console.error("Could not find hairstyle-grid-inner-list element");

  // Create 9 copies of lazyNine
  const lazyNineArray = Array.from({ length: 9 }, () => ({
    output_base64: lazyNine
  }));

  // Merge hairstyleData + lazyNine
  const mergedData = [...hairstyleData, ...lazyNineArray];

  // Clear grid
  gridInnerList.innerHTML = '';

  mergedData.forEach((item, index) => {
    const hairstyleItem = document.createElement('div');
    hairstyleItem.className = 'hairstyle-item';
    hairstyleItem.setAttribute('data-model-index', index);
    hairstyleItem.setAttribute('data-name', item.name || 'Hairstyle');
    hairstyleItem.style.opacity = '0'; // start hidden for fade-in

    const recommendedTag = item.recommended
      ? `<span class="tag-recommended"><label>RECOMMENDED</label></span>` : '';

    const isLazyNine = index >= hairstyleData.length;

    hairstyleItem.innerHTML = `
      <div class="hairstyle-img" style="${isLazyNine ? 'opacity:0.6;' : ''}">
        <img src="data:image/png;base64,${item.output_base64}" alt="${item.name || 'Hairstyle'}" />
        ${recommendedTag}
      </div>
      <div class="hairstyle-name">${item.name || 'Hairstyle'}</div>
    `;

    gridInnerList.appendChild(hairstyleItem);

    // Fade-in effect
    setTimeout(() => {
      hairstyleItem.style.transition = 'opacity 0.5s';
      hairstyleItem.style.opacity = '1';
    }, 50 * index);
  });

  console.log(`Rendered ${mergedData.length} hairstyle items`);
}

function renderFirstThreeImages(hairstyleData) {
  const gridInnerList = document.getElementById('first-three-grid-inner-list'); // separate container
  if (!gridInnerList) return console.error("Could not find first-three-grid-inner-list element");

  // Clear grid
  gridInnerList.innerHTML = '';

  hairstyleData.forEach((item, index) => {
    const hairstyleItem = document.createElement('div');
    hairstyleItem.className = 'hairstyle-item';
    hairstyleItem.setAttribute('data-model-index', index);
    hairstyleItem.setAttribute('data-name', item.name || 'Hairstyle');

    const recommendedTag = item.recommended
      ? `<span class="tag-recommended"><label>RECOMMENDED</label></span>` : '';

    hairstyleItem.innerHTML = `
      <div class="hairstyle-img">
        <img src="data:image/png;base64,${item.output_base64}" alt="${item.name || 'Hairstyle'}" />
        ${recommendedTag}
      </div>
      <div class="hairstyle-name">${item.name || 'Hairstyle'}</div>
    `;

    gridInnerList.appendChild(hairstyleItem);
  });

  console.log(`Rendered ${hairstyleData.length} first-three hairstyle items`);
}

data_global_texture = null;
remaining_gallery = null;
centerBase64 = null;
currentBatchIndex = 0;
uploadedFaceBase64 = null;

async function completeScan() {
  console.log("Completing scan process...");
  try {
    // 🟢 Update UI to reflect scan completion
    console.log("Scan complete. Updating UI...");
    $('#scan-progress').css('width', '100%');
    $('#scan-helper-text').text('Scanning Complete...');

    // 🟢 Langsung kasih feedback analyzing (tanpa nunggu fetch selesai)
    setTimeout(() => {
      $('#scan-helper-text').text('Analyzing...');
    }, 500); // kasih delay dikit biar transisinya natural

    // 🟢 Prepare result screen
    const photoContainer = document.querySelector("#captured-photo");
    if (photoContainer) photoContainer.innerHTML = "";

    // 🟢 Proceed only if images haven't been logged and are available
    console.log("Captured count: 1");
    console.log("Captured Images Array:", capturedImages);
    if (capturedImages.length > 0) {
      const straightImage = capturedImages.find(img => img.orientation === "straight");
      const leftImage = capturedImages.find(img => img.orientation === "left");
      const rightImage = capturedImages.find(img => img.orientation === "right");

      if (straightImage) $('<img>').addClass('straight-face').attr('src', straightImage.dataUrl).appendTo('#captured-photo');
      if (leftImage) $('<img>').addClass('left-face').attr('src', leftImage.dataUrl).appendTo('#captured-photo');
      if (rightImage) $('<img>').addClass('right-face').attr('src', rightImage.dataUrl).appendTo('#captured-photo');

      const straightFaceSrc = straightImage?.dataUrl?.split(",")[1];
      const leftFaceSrc = leftImage?.dataUrl?.split(",")[1];
      const rightFaceSrc = rightImage?.dataUrl?.split(",")[1];

      console.log("Captured Images:", {
        straight: !!straightFaceSrc,
        left: !!leftFaceSrc,
        right: !!rightFaceSrc
      });

      if (straightFaceSrc && leftFaceSrc && rightFaceSrc) {
        console.log("Uploading images to backend...");
        fetch("/api/upload-face", { // ✅ remove trailing slash
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            center: straightFaceSrc,
            left: leftFaceSrc,
            right: rightFaceSrc
          })
        })
        .then(res => res.json())
        .then(data => {
          // ✅ Use backend-provided texture URL (supports HTTPS)
          if (data.overlay_base64_raw) {
            console.log("Creating frontend Image from base64...");

            // Create a new Image object
            const textureImg = new Image();

            // Set its src to the base64 string
            textureImg.src = "data:image/png;base64," + data.overlay_base64_raw;
            centerBase64 = data.overlay_base64_raw;
            data_global_texture = "data:image/png;base64," + data.final_uv_overlay;
            remaining_gallery = data.remaining_gallery_base64;
            // remaining_gallery.forEach((imgBase64, index) => {
            //     console.log(`Image ${index + 1}:`, imgBase64);
            // });

            // Optional: styling for preview
            Object.assign(textureImg.style, {
              maxWidth: "300px",
              border: "2px solid #333",
              display: "block",
              marginTop: "10px"
            });

            // Append to DOM for debug/preview
            document.querySelector("#captured-photo").appendChild(textureImg);

            // Now you can use this Image object for your 3D texture
            texturePath = textureImg;
            console.log("Texture Image object created:", textureImg);
          } else {
            console.warn("texture_base64 is missing from API response");
          }

          console.log("Texture path set to:", texturePath);
          console.log("API response received:", data);

          if (data.hairfastgan_results && data.hairfastgan_results.length > 0) {
            lazyNine = data.face_base64;
            uploadedFaceBase64 = data.face_base64;
            renderHairstyleItems(data.hairfastgan_results, lazyNine);
            renderFirstThreeImages(data.hairfastgan_results);
            console.log("Hairstyle data rendered:", data.hairfastgan_results);
          } else {
            console.warn("No hairstyle data in API response");
          }

          if (data.predictions?.center?.class) {
            console.log("Updating face shape UI with:", data.predictions.center.class);
            updateFaceShapeUI(data.predictions.center.class);
          } else {
            console.warn("Predictions center.class is missing");
          }

          console.log("Face shape UI updated.");
          initThreeScene();
          console.log("Three.js scene initialized.");
          console.log("Predictions:", data.predictions);
          console.log("Result image saved at:", data.saved_path);

          // ✅ Display predictions
          const predictionsDiv = document.createElement("div");
          predictionsDiv.innerHTML = `
            <h3>Face Shape Predictions</h3>
            <p><strong>Center:</strong> ${data.predictions?.center?.class || "-"} (${data.predictions?.center?.confidence || "-"})</p>
            <p><strong>Left:</strong> ${data.predictions?.left?.class || "-"} (${data.predictions?.left?.confidence || "-"})</p>
            <p><strong>Right:</strong> ${data.predictions?.right?.class || "-"} (${data.predictions?.right?.confidence || "-"})</p>
          `;
          document.querySelector("#captured-photo").appendChild(predictionsDiv);


          // ✅ Display result image
          const resultImg = document.createElement("img");
          resultImg.src = "data:image/png;base64," + data.overlay_base64_raw;
          resultImg.style.maxWidth = "300px";
          resultImg.style.border = "2px solid #333";
          resultImg.style.display = "block";
          resultImg.style.marginTop = "10px";
          document.querySelector("#captured-photo").appendChild(resultImg);
          console.log("Displaying result image from API response");
          if (data.overlay_base64_raw) {
            console.log("Displaying overlay image from API response");
            console.log("Overlay base64 length:", data.overlay_base64_raw?.length);
            const resultImg = document.createElement("img");
            resultImg.src = "data:image/png;base64," + data.overlay_base64_raw;
            Object.assign(resultImg.style, {
              maxWidth: "300px",
              border: "2px solid #333",
              display: "block",
              marginTop: "10px"
            });
            // console.log("%c ", "font-size:200px; background:url(" + resultImg.src + ") no-repeat; background-size:contain;");
            document.querySelector("#captured-photo").appendChild(resultImg);
          } else {
            console.warn("overlay_base64_raw is missing from API response");
          }


          // Tampilkan analyzing
          $('#scan-helper-text').text('Recomendation Ready!');
          // Tunggu 1 detik sebelum pindah screen
          setTimeout(() => {
            showScreen('pageQuestionHair');
          }, 1000);
        })
        .catch(err => {
          console.error("Upload error:", err);
          // Tampilkan pesan error
          $('#scan-helper-text').text('Error. Please try again.');
          // Dalam 3 detik, kembali ke scan screen
          setTimeout(() => {
            // Reset state scan
            startCapture = false;
            lookedRight = false;
            lookedLeft = false;
            lookedStraight = false;
            currentStepIndex = 0;
            capturedImages = [];
            if (typeof scanSteps !== "undefined" && scanSteps[currentStepIndex]) {
              $('#scan-helper-text').text(scanSteps[currentStepIndex].text);
            } else {
              $('#scan-helper-text').text("Start Scan");
            }
            $('#scan-progress').css('width', '0%');
            $('#scan-btn').css('pointer-events', 'all').html('Start Scan');
            showScreen('scanHair');
          }, 3000);
        });

      } else {
        const warningMsg = document.createElement("div");
        warningMsg.textContent = "Could not capture all required angles. Please try again.";
        Object.assign(warningMsg.style, {
          color: "#ff8800",
          textAlign: "center",
          margin: "20px 0"
        });
        photoContainer.appendChild(warningMsg);
      }

    } else {
      console.log("Images already processed previously.");
    }

  } catch (err) {
    console.error("Error in completeScan():", err);
    alert("An unexpected error occurred during scan completion");

    const fallback = document.createElement("div");
    fallback.textContent = "Unexpected error. Please try again.";
    Object.assign(fallback.style, {
      color: "#ff4444",
      textAlign: "center",
      margin: "20px 0"
    });
    document.querySelector("#captured-photo").appendChild(fallback);
  }
}

let selectedHairStyleName = '';

// Fungsi untuk mengupdate nama hairstyle di sidebar
function updateSidebarHairStyle() {
  const sidebarElement = document.getElementById("sidebar-hair-style");
  if (sidebarElement) {
    sidebarElement.textContent = selectedHairStyleName;
  }
}

document.getElementById("showGalleryBtn").addEventListener("click", async () => {
    try {
        const response = await fetch("/api/process-remaining-gallery", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                center: centerBase64
            })
        });

        const data = await response.json();

        const galleryBase64 = data.remaining_gallery_base64; // array of processed gallery images
        const container = document.getElementById("galleryContainer");
        container.innerHTML = ""; // clear previous images

        galleryBase64.forEach((imgBase64, index) => {
            console.log(`Gallery Image ${index + 1}:`, imgBase64);

            const img = document.createElement("img");
            img.src = `data:image/png;base64,${imgBase64}`;
            img.style.width = "150px";
            img.style.margin = "5px";

            container.appendChild(img);
        });

    } catch (err) {
        console.error("Error fetching gallery images:", err);
    }
});

// Event listener untuk item hairstyle
document.addEventListener("DOMContentLoaded", function() {
  // Gunakan event delegation untuk menangani klik pada hairstyle-item
  document.addEventListener("click", function(e) {
    const hairstyleItem = e.target.closest(".hairstyle-item");
    if (hairstyleItem) {
      // Ambil nama hairstyle dari elemen .hairstyle-name
      const hairStyleNameElement = hairstyleItem.querySelector(".hairstyle-name");
      if (hairStyleNameElement) {
        selectedHairStyleName = hairStyleNameElement.textContent;
        // Update teks di sidebar
        updateSidebarHairStyle();
        
        // Hapus class active dari semua item
        document.querySelectorAll(".hairstyle-item").forEach(item => {
          item.classList.remove("active");
        });
        
        // Tambahkan class active ke item yang dipilih
        hairstyleItem.classList.add("active");
      }
    }
  });
  
  // Inisialisasi sidebar dengan nilai default
  updateSidebarHairStyle();
});

  // --- Your Three.js scene setup ---
  function initThreeScene() {
    const container = document.querySelector('.scene-container');
    container.classList.remove('d-none');

    const scene = new THREE.Scene();
    scene.background = null;
    
    const camera = new THREE.PerspectiveCamera(60, 700 / 450, 0.1, 100);
    camera.position.set(0, 2, 2);

    const myCanvas = document.getElementById('renderCanvas1');
    const renderer = new THREE.WebGLRenderer({
      canvas: myCanvas,
      // antialias: true,
      alpha: true,
      preserveDrawingBuffer: true
    });
    renderer.setSize(700, 450);

    
    
    //pencahayaan tambahan
    const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    dirLight.position.set(0, 10, 10);
    scene.add(dirLight);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.enableZoom = true;
    controls.enablePan = false;
    controls.enableRotate = false;
    controls.target.set(0, 2, 0);

    scene.add(new THREE.AmbientLight(0xffffff, 1.5));

    //
    let faceModel = null;
    let currentHair = null;

    const loader = new THREE.GLTFLoader();
    const textureLoader = new THREE.TextureLoader();
    const texturePath = data_global_texture;
    const texture = textureLoader.load(texturePath, () => {
      // Texture loaded callback
      texture.flipY = false;                // ✅ prevent flipping
      texture.encoding = THREE.sRGBEncoding; // optional for correct colors
    });

    // --- Load Face Model ---
    loader.load('./assets/models/head_bagus.glb', (gltf) => {
      faceModel = gltf.scene;
      faceModel.position.set(0, -12.35, 0);
      faceModel.scale.set(9, 9, 9);
      scene.add(faceModel);

      // Apply the texture
      faceModel.traverse((child) => {
        if (child.isMesh) {
          if (child.material) {
            child.material.map = texture;
          } else {
            child.material = new THREE.MeshStandardMaterial({
              map: texture,
              transparent: true,
              side: THREE.DoubleSide,
            });
          }
          child.material.needsUpdate = true;
        }
      });
    });


    // Fungsi untuk set target rotasi kamera (clamp -45° sampai 45°)
    function setRotationY(angle) {
      const min = THREE.MathUtils.degToRad(-18);
      const max = THREE.MathUtils.degToRad(180); //ganti ini

      targetAngle = Math.min(Math.max(angle, min), max);
    }

    // --- Event Button Hairstyle ---
    $('.hairstyle-item').click(function () {
      const index = $(this).attr('data-model-index');
      const files = [
        '/assets/models/Medium-LengthSidePart.glb',
        '/assets/models/Layered.glb',
        '/assets/models/SlickBack.glb'
      ];

      loadHairstyle(files[index]);

      $('.hairstyle-item').removeClass('active');
      $(this).addClass('active');
    });

    let isLoadingHair = false; // flag loading

    // --- Load Hairstyle on button click ---
    function loadHairstyle(path) {
      if (!faceModel) {
        console.warn("Face model belum loaded.");
        return;
      }
      if (isLoadingHair) {
        console.log("Masih loading hairstyle, tunggu sebentar...");
        return; // jangan load baru kalau sebelumnya belum selesai
      }

      isLoadingHair = true;

      // Hapus hairstyle lama
      if (currentHair) {
        scene.remove(currentHair);
        currentHair.traverse((child) => {
          if (child.isMesh) {
            child.geometry.dispose();
            if (child.material.isMaterial) {
              cleanMaterial(child.material);
            } else {
              child.material.forEach(mat => cleanMaterial(mat));
            }
          }
        });
        currentHair = null;
      }

      loader.load(path, (gltf) => {
        const hair = gltf.scene;

        // posisikan relatif di atas face
        hair.position.set(-0, -12.455, 0.01);
        hair.scale.set(9, 9, 9);

        hair.traverse((child) => {
          if (child.isMesh) {
            if (!child.material) {
              child.material = new THREE.MeshStandardMaterial({ color: 0xffffff });
            }
            child.material.transparent = true;
            child.material.side = THREE.FrontSide;
            child.material.alphaTest = 0.5;
            child.material.depthWrite = true;
            child.material.depthTest = true;
            child.renderOrder = 1;
            child.geometry.computeVertexNormals();
          }
        });

        scene.add(hair);
        currentHair = hair;
        isLoadingHair = false; // selesai load
      });
    }

    function cleanMaterial(material) {
      material.dispose();
      for (const key in material) {
        if (material[key] && material[key].isTexture) {
          material[key].dispose();
        }
      }
    }

    // --- Animate loop ---
    const clock = new THREE.Clock();

    function animate() {
      requestAnimationFrame(animate);

      // Smooth rotation ke targetAngle
      currentAngle += (targetAngle - currentAngle) * 0.1;

      camera.position.x = 5 * Math.sin(currentAngle);
      camera.position.z = 5 * Math.cos(currentAngle);
      camera.lookAt(0, 2, 0);

      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // Tombol kiri
    document.getElementById('btnLeft').addEventListener('click', () => {
      setRotationY(targetAngle - THREE.MathUtils.degToRad(20));
    });

    // Tombol kanan
    document.getElementById('btnRight').addEventListener('click', () => {
      setRotationY(targetAngle + THREE.MathUtils.degToRad(20));
    });
  }

  function captureCanvas() {
      const canvas = document.getElementById('renderCanvas1');
      
      try {
        const imageData = canvas.toDataURL('image/png');
        displayCapturedImage(imageData);
      } catch (e) {
        console.error("Error capturing canvas:", e);
        alert("Failed to capture image. Please try again.");
      }
    }

    // Tampilkan gambar hasil tangkapan
    function displayCapturedImage(imageData) {
      const capturedImage = document.getElementById('result-hairstyle-img');
      capturedImage.src = imageData;
      document.getElementById('model-img').style.display = 'block';
    }

    // Event listener untuk tombol capture
document.getElementById('hairstyle-continue-btn').addEventListener('click', captureCanvas);

let selectedHairStyle = {
    modelSrc: '',
    name: '',
    description: ''
  };

    // Data untuk setiap hairstyle
const hairStyleData = {
  0: {
    modelSrc: '/assets/models/model-4.glb',
    name: 'TWO BLOCK',
    description: 'A relaxed and stylish look with natural waves framing the face. The curtain-style fringe gives off a soft, youthful vibe while maintaining a sense of effortless charm. Perfect for casual everyday wear or characters that embody freedom and creativity.'
  },
  1: {
    modelSrc: '/assets/models/model-5.glb',
    name: 'BUZZCUT',
    description: 'A timeless hairstyle that highlights confidence and elegance. With its clean, backward flow and subtle volume, it draws attention to the face and sharpens the overall look. Ideal for formal settings, professional styles, or characters that need a refined, sophisticated presence.'
  },
  2: {
    modelSrc: '/assets/models/model-12.glb',
    name: 'FRENCH CROP',
    description: 'A modern, low-maintenance haircut with sharp texture on top and clean sides. This hairstyle balances simplicity with a bold edge, giving off an energetic and masculine vibe. Great for active lifestyles or characters that value strength, practicality, and straightforward style.'
  }
};

    // Fungsi untuk mengupdate product screen dengan hairstyle yang dipilih
function updateProductScreen() {
  // Update model viewer
  const modelViewer = document.getElementById('product-model-viewer');
  if (modelViewer) {
    modelViewer.setAttribute('src', selectedHairStyle.modelSrc);
  }
  
  // Update nama hairstyle
  const nameElement = document.getElementById('product-hair-style-name');
  if (nameElement) {
    nameElement.textContent = selectedHairStyle.name;
  }
  
  // Update deskripsi hairstyle
  const descElement = document.getElementById('product-hair-style-desc');
  if (descElement) {
    descElement.textContent = selectedHairStyle.description;
  }
}

    // Event listener untuk item hairstyle
document.addEventListener("DOMContentLoaded", function() {
  // Gunakan event delegation untuk menangani klik pada hairstyle-item
  document.addEventListener("click", function(e) {
    const hairstyleItem = e.target.closest(".hairstyle-item");
    if (hairstyleItem) {
      const index = hairstyleItem.getAttribute("data-model-index");
      
      // Update selectedHairStyle dengan data dari hairStyleData
      if (hairStyleData[index]) {
        selectedHairStyle = hairStyleData[index];
        
        // Update sidebar jika ada
        updateSidebarHairStyle();
      }
    }
  });
  
  // Event listener untuk tombol next di hairstyle screen
  const continueButton = document.getElementById("hairstyle-continue-btn");
  if (continueButton) {
    continueButton.addEventListener("click", function() {
      // Update product screen sebelum menampilkannya
      updateProductScreen();
      showScreen(product);
    });
  }
});

document.addEventListener('DOMContentLoaded', function() {
      // Hair Type Selection Logic
      const hairTypeOptions = document.querySelectorAll('.question-list');
      const hairTypeDetail = document.querySelector('.hair-type-detail');
      
      hairTypeOptions.forEach(option => {
          option.addEventListener('click', function() {
              // Hapus kelas 'selected' dari semua opsi
              hairTypeOptions.forEach(opt => opt.classList.remove('selected'));
              
              // Tambahkan kelas 'selected' ke opsi yang diklik
              this.classList.add('selected');
              
              // Ambil nilai dari opsi yang dipilih
              const selectedHairType = this.getAttribute('data-value');
              
              // Simpan nilai ke dalam elemen hair-type-detail
              hairTypeDetail.textContent = selectedHairType;
              
              // Simpan pilihan user (bisa dikembangkan untuk disimpan ke database)
              console.log('User memilih jenis rambut:', selectedHairType);
          });
      });
      
      // Hairstyle Selection Logic
      const hairstyleItems = document.querySelectorAll('#hairstyle-list-screen .hairstyle-item');
      const selectedSlots = document.querySelectorAll('.hairstyle-grid-inner .hairstyle-item');
      
      // Inisialisasi state
      let selectedHairstyles = [
          { modelSrc: "/assets/models/model-4.glb", name: "TWO BLOCK", recommended: true },
          { modelSrc: "/assets/models/model-5.glb", name: "BUZZCUT", recommended: true },
          { modelSrc: "/assets/models/model-12.glb", name: "FRENCH CROP", recommended: true }
      ];
      
      // Fungsi untuk mengupdate tampilan slot yang dipilih
      function updateSelectedSlots() {
          selectedSlots.forEach((slot, index) => {
              if (index < selectedHairstyles.length) {
                  const hairstyleData = selectedHairstyles[index];
                  
                  // Update model-viewer
                  const modelViewer = slot.querySelector('model-viewer');
                  modelViewer.setAttribute('src', hairstyleData.modelSrc);
                  modelViewer.setAttribute('alt', hairstyleData.name);
                  
                  // Update nama
                  const nameElement = slot.querySelector('.hairstyle-name');
                  nameElement.textContent = hairstyleData.name;
                  
                  // Update tag recommended
                  const recommendedTag = slot.querySelector('.tag-recommended');
                  if (hairstyleData.recommended) {
                      if (!recommendedTag) {
                          const newTag = document.createElement('span');
                          newTag.className = 'tag-recommended';
                          newTag.innerHTML = '<label>RECOMMENDED</label>';
                          slot.querySelector('.hairstyle-img').appendChild(newTag);
                      }
                  } else if (recommendedTag) {
                      recommendedTag.remove();
                  }

                  console.log('Slot', index, 'updated with', hairstyleData);
              }
          });
          
          console.log('Gaya rambut terpilih:', selectedHairstyles);
      }
      
      // Event listener untuk item gaya rambut
      hairstyleItems.forEach(item => {
          item.addEventListener('click', function() {
              // Dapatkan data dari item yang diklik
              const modelSrc = this.getAttribute('data-model-src');
              const name = this.getAttribute('data-name');
              const recommended = this.getAttribute('data-recommended') === 'true';
            
              console.log('Item clicked:', { modelSrc, name, recommended });
              
              // Tambahkan item baru di awal array
              selectedHairstyles.unshift({
                  modelSrc,
                  name,
                  recommended
              });
              
              // Jika lebih dari 3 item, hapus item terakhir
              if (selectedHairstyles.length > 3) {
                  selectedHairstyles.pop();
              }
              
              // Update tampilan
              updateSelectedSlots();
              
              // Tandai item yang dipilih
              hairstyleItems.forEach(i => i.classList.remove('selected'));
              this.classList.add('selected');
          });
      });
      
      // Inisialisasi tampilan
      updateSelectedSlots();
  });
  
</script>
    <script type="module" src="/assets/js/ui.js"></script>
</body>

</html>